# Function Tools

## Overview

Function tools enable agents to perform actions beyond text generation by calling C# methods. Agents can decide when and how to use tools based on the user's request.

## Quick Start

```csharp
using LlmTornado.Agents;

// Define tool functions
[Description("get the weather")]
string GetWeather([Description("city to get weather from")] string city)
{
    return $"Weather in {city}: 22Â°C, Sunny";
}

[Description("perform add Or multiply math Calculation")]
string Calculate(
[Description("math operation to perform (add or multiply)")] 
string operation, 
double a, double b)
{
    double result =  operation switch
    {
        "add" => a + b,
        "multiply" => a * b,
        _ => 0
    };

    return result.ToString();
}

// Create agent with tools
TornadoAgent agent = new TornadoAgent(
    client: api,
    model: ChatModel.OpenAi.Gpt41.V41,
    instructions: "You are a helpful assistant with weather and calculation tools.",
    tools: [GetWeather, Calculate]  
);

Conversation result = await agent.RunAsync("What's the weather in Prague?");
```

## Tool Definition

### Simple Function Tool

```csharp
string MyTool(string param1, int param2)
{
    // Tool implementation
    return $"Result: {param1} - {param2}";
}

TornadoAgent agent = new TornadoAgent(
    api, model,
    tools: [MyTool] 
);
```

### Adding Tools Dynamically

```csharp
TornadoAgent agent = new TornadoAgent(api, model);

Tool newTool = new Tool(
    (string input) => $"Processed: {input}",
    "process_text",
    "Processes text input"
);

agent.AddTornadoTool(newTool);
```

## Tool Parameters

### Supported Types
- Primitive types: `string`, `int`, `double`, `bool`, `DateTime`
- Collections:  `T[]`
- Complex types: Custom classes/structs
- Enums: Strongly-typed enumerations

## Tool Permissions

Control which tools require user permission:

```csharp
Dictionary<string, bool> permissions = new Dictionary<string, bool>
{
    ["dangerous_operation"] = true,  // Requires permission
    ["safe_operation"] = false       // No permission needed
};

TornadoAgent agent = new TornadoAgent(
    api, model,
    tools: toolList,
    toolPermissionRequired: permissions
);
```

## Best Practices

### Tool Design
- Keep tools focused on single responsibilities
- Use descriptive names and parameters
- Return meaningful, actionable results
- Handle errors gracefully

### Error Handling

```csharp
string SafeTool(string input)
{
    try
    {
        // Tool logic
        return "Success";
    }
    catch (Exception ex)
    {
        return $"Error: {ex.Message}";
    }
}
```

### Documentation

```csharp
/// <summary>
/// Retrieves weather information for a specified city.
/// </summary>
/// <param name="city">The name of the city</param>
/// <param name="units">Temperature units (celsius/fahrenheit)</param>
/// <returns>Weather information as a formatted string</returns>
string GetWeather(string city, string units = "celsius")
{
    // Implementation
}
```

## Common Issues

### Tool Not Being Called
**Solutions**:
- Ensure model supports function calling
- Check tool description is clear
- Verify instructions mention tool availability

### Argument Type Mismatch
**Solutions**:
- Use correct C# types
- Implement ToolArguments for flexibility
- Add validation in tool implementation

## Related Topics

- [Agent Basics](../1.%20basics.md)
- [Response Tools](./2.%20Response-Tools.md)
- [MCP Tools](./3.%20MCP%20Tools.md)
- [Chat Functions](../../../1.%20LlmTornado/1.%20Chat/4.%20functions.md)
